<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Letter Tamer: Braille Edition</title>
    <style>
        :root {
            --plastic-dark: #1a1a1a;
            --plastic-light: #2a2a2a;
            --neon-blue: #00f2ff;
            --neon-pink: #ff00de;
            --neon-yellow: #ffee00;
            --lcd-bg: #102a30;
            --lcd-on: #00ffea;
            --p1-color: #00a2ff;
            --p2-color: #ffaa00;
            --p3-color: #ff3333;
        }

        body {
            background: radial-gradient(circle at center, #2b2b2b 0%, #000000 100%);
            color: white;
            font-family: 'Courier New', Courier, monospace;
            height: 100vh;
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            user-select: none;
        }

        /* --- UI Overlay --- */
        #ui-layer {
            position: absolute;
            top: 20px;
            right: 20px;
            z-index: 100;
            display: flex;
            flex-direction: column;
            gap: 10px;
            align-items: flex-end;
        }

        button.btn-retro {
            background: #444;
            border: 2px solid #888;
            color: white;
            padding: 10px 20px;
            font-family: inherit;
            font-weight: bold;
            text-transform: uppercase;
            cursor: pointer;
            box-shadow: 4px 4px 0px #000;
            transition: transform 0.1s;
        }
        button.btn-retro:active {
            transform: translate(2px, 2px);
            box-shadow: 2px 2px 0px #000;
        }

        #braille-guide {
            display: none;
            background: rgba(0,0,0,0.95);
            border: 2px solid var(--neon-blue);
            padding: 15px;
            border-radius: 10px;
            font-size: 14px;
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            width: 220px;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            max-height: 80vh;
            overflow-y: auto;
        }
        #braille-guide.visible {
            opacity: 1;
            pointer-events: auto;
        }

        /* --- Main Game Unit --- */
        .game-unit {
            width: 500px;
            height: 500px;
            position: relative;
            background: linear-gradient(135deg, #333 0%, #111 100%);
            border-radius: 60px;
            box-shadow: 
                0 0 0 10px #111,
                0 0 20px 5px rgba(0, 242, 255, 0.2), 
                inset 5px 5px 15px rgba(255,255,255,0.1),
                inset -5px -5px 15px rgba(0,0,0,0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            clip-path: polygon(50% 0%, 95% 25%, 95% 75%, 50% 100%, 5% 75%, 5% 25%);
        }
        
        /* Neon Tube Border */
        .neon-rim {
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            border-radius: 60px;
            z-index: 10;
            pointer-events: none;
            box-shadow: inset 0 0 20px var(--neon-blue);
            border: 4px solid rgba(0, 242, 255, 0.3);
            clip-path: polygon(50% 0%, 95% 25%, 95% 75%, 50% 100%, 5% 75%, 5% 25%);
        }

        /* Texture Background */
        .zone-bg {
            position: absolute;
            width: 100%;
            height: 100%;
            z-index: 0;
            opacity: 0.3;
        }
        .texture-zebra {
            background: repeating-linear-gradient(45deg, #000, #000 10px, #fff 10px, #fff 20px);
            mask-image: linear-gradient(to right, black, transparent);
            transform: rotate(-30deg) scale(1.5);
            top: -100px; left: -100px;
        }
        
        /* --- Central LCD --- */
        .lcd-bezel {
            width: 220px;
            height: 220px;
            background: radial-gradient(#555, #222);
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 
                0 5px 15px rgba(0,0,0,0.8),
                inset 0 2px 5px rgba(255,255,255,0.3);
            z-index: 20;
            border: 8px solid #111;
        }

        .lcd-screen {
            width: 170px;
            height: 170px;
            background-color: var(--lcd-bg);
            border-radius: 50%;
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            box-shadow: inset 0 0 20px #000;
        }

        .lcd-screen::after {
            content: " ";
            display: block;
            position: absolute;
            top: 0; left: 0; bottom: 0; right: 0;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%);
            background-size: 100% 4px;
            z-index: 2;
            pointer-events: none;
        }

        .animal-display {
            font-size: 80px;
            filter: drop-shadow(0 0 5px var(--lcd-on));
            transition: transform 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        
        .lcd-text {
            color: var(--lcd-on);
            font-family: 'Courier New', Courier, monospace;
            font-weight: bold;
            font-size: 14px;
            text-shadow: 0 0 5px var(--lcd-on);
            margin-top: 10px;
            text-transform: uppercase;
            text-align: center;
        }

        /* --- Player Controls --- */
        .control-zone {
            position: absolute;
            width: 140px;
            height: 180px;
            z-index: 10;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: rgba(255,255,255,0.05);
            border-radius: 15px;
            border: 1px solid rgba(255,255,255,0.1);
            backdrop-filter: blur(2px);
            padding: 10px;
        }
        .control-zone.winner-glow {
            animation: winPulse 0.5s infinite alternate;
        }

        .p1-human {
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            box-shadow: 0 0 15px var(--p1-color);
        }
        .p2-cpu {
            top: 50px;
            left: 20px;
            transform: rotate(-60deg);
            box-shadow: 0 0 5px var(--p2-color);
            opacity: 0.9;
        }
        .p3-cpu {
            top: 50px;
            right: 20px;
            transform: rotate(60deg);
            box-shadow: 0 0 5px var(--p3-color);
            opacity: 0.9;
        }

        .player-label {
            font-size: 10px;
            text-transform: uppercase;
            margin-bottom: 5px;
            color: #fff;
            background: #000;
            padding: 2px 5px;
            border-radius: 4px;
        }

        /* Braille Keyboard */
        .braille-pad {
            display: grid;
            grid-template-columns: 1fr 1fr;
            grid-template-rows: repeat(3, 1fr);
            gap: 12px;
            padding: 10px;
            background: #222;
            border-radius: 10px;
            box-shadow: inset 2px 2px 5px #000, inset -1px -1px 2px #444;
        }

        .b-key {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            background: #333;
            border: none;
            box-shadow: 
                0 5px 0 #111, 
                0 5px 5px rgba(0,0,0,0.5),
                inset 2px 2px 5px rgba(255,255,255,0.1);
            cursor: pointer;
            transition: all 0.1s;
            position: relative;
        }

        .b-key.active {
            transform: translateY(3px);
            box-shadow: 
                0 2px 0 #111,
                inset 2px 2px 5px rgba(0,0,0,0.5);
        }
        
        .p1-human .b-key.active { background: radial-gradient(circle at 30% 30%, #00a2ff, #005588); }
        .p2-cpu .b-key.active { background: radial-gradient(circle at 30% 30%, #ffaa00, #885500); }
        .p3-cpu .b-key.active { background: radial-gradient(circle at 30% 30%, #ff3333, #880000); }
        
        /* Fake CPU Press Effect */
        .b-key.cpu-press {
            background: #555;
            transform: translateY(3px);
        }

        /* --- Scoreboard --- */
        .score-display {
            position: absolute;
            bottom: -80px;
            width: 300px;
            display: flex;
            justify-content: space-between;
            background: #000;
            border: 2px solid #333;
            padding: 10px;
            border-radius: 10px;
            font-family: 'Courier New', Courier, monospace;
        }
        .score-box { text-align: center; }
        .score-val { font-size: 20px; font-weight: bold; }
        
        @keyframes winPulse {
            from { box-shadow: 0 0 10px white; }
            to { box-shadow: 0 0 30px var(--neon-yellow); }
        }

        #message-overlay {
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            font-size: 60px;
            font-weight: 900;
            color: #fff;
            text-shadow: 0 0 20px var(--neon-pink);
            z-index: 100;
            display: none;
            pointer-events: none;
            background: rgba(0,0,0,0.8);
            padding: 20px;
            border-radius: 20px;
            text-align: center;
        }
    </style>
</head>
<body>

    <div id="ui-layer">
        <button class="btn-retro" onclick="toggleGuide()">Show Braille Guide</button>
        <div id="braille-guide">
            <!-- JS fills this -->
        </div>
    </div>

    <div class="game-unit">
        <div class="zone-bg texture-zebra"></div>
        <div class="neon-rim"></div>

        <!-- CPU 1 (Top Left) -->
        <div class="control-zone p2-cpu" id="cpu1">
            <div class="player-label">CPU 1</div>
            <div class="braille-pad">
                <div class="b-key c1-key"></div><div class="b-key c1-key"></div>
                <div class="b-key c1-key"></div><div class="b-key c1-key"></div>
                <div class="b-key c1-key"></div><div class="b-key c1-key"></div>
            </div>
        </div>

        <!-- CPU 2 (Top Right) -->
        <div class="control-zone p3-cpu" id="cpu2">
            <div class="player-label">CPU 2</div>
            <div class="braille-pad">
                <div class="b-key c2-key"></div><div class="b-key c2-key"></div>
                <div class="b-key c2-key"></div><div class="b-key c2-key"></div>
                <div class="b-key c2-key"></div><div class="b-key c2-key"></div>
            </div>
        </div>

        <!-- Central LCD -->
        <div class="lcd-bezel">
            <div class="lcd-screen">
                <div class="animal-display" id="animal-emoji">ü¶Å</div>
                <div class="lcd-text" id="status-text">LOADING...</div>
            </div>
        </div>

        <!-- Player (Bottom) -->
        <div class="control-zone p1-human" id="player">
            <div class="player-label">YOU (Type 1st Letter)</div>
            <div class="braille-pad" id="player-pad">
                <button class="b-key" onclick="toggleDot(0)"></button>
                <button class="b-key" onclick="toggleDot(3)"></button>
                
                <button class="b-key" onclick="toggleDot(1)"></button>
                <button class="b-key" onclick="toggleDot(4)"></button>
                
                <button class="b-key" onclick="toggleDot(2)"></button>
                <button class="b-key" onclick="toggleDot(5)"></button>
            </div>
        </div>
        
        <div id="message-overlay">WIN!</div>
    </div>

    <div class="score-display">
        <div class="score-box" style="color:var(--p2-color)">CPU 1<br><span class="score-val" id="s-cpu1">0</span></div>
        <div class="score-box" style="color:var(--p1-color)">YOU<br><span class="score-val" id="s-p1">0</span></div>
        <div class="score-box" style="color:var(--p3-color)">CPU 2<br><span class="score-val" id="s-cpu2">0</span></div>
    </div>

    <script>
        // --- Data ---
        // Braille: [LeftCol(1,2,3), RightCol(4,5,6)]
        const brailleMap = {
            'A': [1,0,0,0,0,0], 'B': [1,1,0,0,0,0], 'C': [1,0,0,1,0,0], 'D': [1,0,0,1,1,0],
            'E': [1,0,0,0,1,0], 'F': [1,1,0,1,0,0], 'G': [1,1,0,1,1,0], 'H': [1,1,0,0,1,0],
            'I': [0,1,0,1,0,0], 'J': [0,1,0,1,1,0], 'K': [1,0,1,0,0,0], 'L': [1,1,1,0,0,0],
            'M': [1,0,1,1,0,0], 'N': [1,0,1,1,1,0], 'O': [1,0,1,0,1,0], 'P': [1,1,1,1,0,0],
            'Q': [1,1,1,1,1,0], 'R': [1,1,1,0,1,0], 'S': [0,1,1,1,0,0], 'T': [0,1,1,1,1,0],
            'U': [1,0,1,0,0,1], 'V': [1,1,1,0,0,1], 'W': [0,1,0,1,1,1], 'X': [1,0,1,1,0,1],
            'Y': [1,0,1,1,1,1], 'Z': [1,0,1,0,1,1]
        };

        const animals = [
            { name: "Bear", emoji: "üêª" }, { name: "Cat", emoji: "üê±" },
            { name: "Dog", emoji: "üê∂" }, { name: "Fox", emoji: "ü¶ä" },
            { name: "Horse", emoji: "üê¥" }, { name: "Lion", emoji: "ü¶Å" },
            { name: "Monkey", emoji: "üêµ" }, { name: "Panda", emoji: "üêº" },
            { name: "Pig", emoji: "üê∑" }, { name: "Rabbit", emoji: "üê∞" },
            { name: "Snake", emoji: "üêç" }, { name: "Tiger", emoji: "üêØ" },
            { name: "Wolf", emoji: "üê∫" }, { name: "Zebra", emoji: "ü¶ì" }
        ];

        // --- State ---
        let currentLetter = "";
        let playerPattern = [0,0,0,0,0,0];
        let gameActive = false;
        let scores = { p1: 0, cpu1: 0, cpu2: 0 };
        let botTimers = [];
        let botIntervals = [];

        // --- Elements ---
        const animalEmoji = document.getElementById('animal-emoji');
        const statusText = document.getElementById('status-text');
        const playerButtons = document.querySelectorAll('#player-pad .b-key');
        const overlay = document.getElementById('message-overlay');

        // --- Init ---
        window.onload = function() {
            initGuide();
            startGame();
        };

        function initGuide() {
            const guide = document.getElementById('braille-guide');
            Object.keys(brailleMap).forEach(key => {
                let p = brailleMap[key];
                let div = document.createElement('div');
                div.style.fontFamily = "monospace";
                // Simple visual representation of dots
                let grid = `${p[0]?'‚óè':'‚óã'} ${p[3]?'‚óè':'‚óã'}<br>${p[1]?'‚óè':'‚óã'} ${p[4]?'‚óè':'‚óã'}<br>${p[2]?'‚óè':'‚óã'} ${p[5]?'‚óè':'‚óã'}`;
                div.innerHTML = `<span style="color:var(--neon-blue); font-size:16px">${key}</span><br>${grid}`;
                guide.appendChild(div);
            });
        }

        function toggleGuide() {
            document.getElementById('braille-guide').classList.toggle('visible');
        }

        function startGame() {
            nextRound();
        }

        function nextRound() {
            gameActive = false;
            playerPattern = [0,0,0,0,0,0];
            updatePlayerVisuals();
            overlay.style.display = 'none';
            
            // Remove glow classes
            ['player', 'cpu1', 'cpu2'].forEach(id => {
                document.getElementById(id).classList.remove('winner-glow');
            });
            // Clear CPU keys visual state
            document.querySelectorAll('.c1-key, .c2-key').forEach(k => k.classList.remove('active', 'cpu-press'));

            // Stop old bots
            botTimers.forEach(t => clearTimeout(t));
            botIntervals.forEach(i => clearInterval(i));
            botTimers = [];
            botIntervals = [];

            // Spin Animation
            statusText.innerText = "SEARCHING...";
            animalEmoji.style.transform = "scale(0) rotate(-180deg)";

            setTimeout(() => {
                const animal = animals[Math.floor(Math.random() * animals.length)];
                currentLetter = animal.name.charAt(0).toUpperCase();
                
                animalEmoji.innerText = animal.emoji;
                animalEmoji.style.transform = "scale(1) rotate(0deg)";
                statusText.innerText = "GUESS: " + currentLetter;
                gameActive = true;

                setupBots();
            }, 1200);
        }

        // --- Player Logic ---
        function toggleDot(index) {
            if(!gameActive) return;
            playerPattern[index] = playerPattern[index] ? 0 : 1;
            updatePlayerVisuals();
            checkWin('p1');
        }

        function updatePlayerVisuals() {
            playerButtons.forEach((btn, i) => {
                if(playerPattern[i]) btn.classList.add('active');
                else btn.classList.remove('active');
            });
        }

        // --- Bot Logic ---
        function setupBots() {
            // Difficulty: Random time between 4 seconds and 10 seconds
            const t1 = 4000 + Math.random() * 6000;
            const t2 = 4000 + Math.random() * 6000;

            // Win Timers
            botTimers.push(setTimeout(() => checkWin('cpu1'), t1));
            botTimers.push(setTimeout(() => checkWin('cpu2'), t2));

            // Typing Animation
            botIntervals.push(setInterval(() => animateBot('c1-key'), 400));
            botIntervals.push(setInterval(() => animateBot('c2-key'), 550));
        }

        function animateBot(className) {
            if(!gameActive) return;
            const keys = document.querySelectorAll('.' + className);
            // Randomly "press" a key visually
            const r = Math.floor(Math.random() * keys.length);
            keys[r].classList.add('cpu-press');
            setTimeout(() => keys[r].classList.remove('cpu-press'), 200);
        }

        // --- Win Logic ---
        function checkWin(who) {
            if(!gameActive) return;

            let isWin = false;
            
            if(who === 'p1') {
                const target = brailleMap[currentLetter];
                if(JSON.stringify(playerPattern) === JSON.stringify(target)) {
                    isWin = true;
                }
            } else {
                // Bots automatically win if their timer fires and game is still active
                isWin = true;
            }

            if(isWin) {
                triggerWin(who);
            }
        }

        function triggerWin(winner) {
            gameActive = false;
            scores[winner]++;
            document.getElementById(`s-${winner}`).innerText = scores[winner];

            // Show results
            overlay.style.display = 'block';
            
            if(winner === 'p1') {
                overlay.innerText = `YOU GOT IT!\n${currentLetter} is for ${getAnimalName()}`;
                overlay.style.color = "var(--neon-blue)";
                document.getElementById('player').classList.add('winner-glow');
                statusText.innerText = "WINNER: YOU";
            } else {
                let name = winner === 'cpu1' ? "CPU 1" : "CPU 2";
                overlay.innerText = `${name} WINS!\nToo Slow!`;
                overlay.style.color = "var(--neon-pink)";
                document.getElementById(winner).classList.add('winner-glow');
                statusText.innerText = "WINNER: " + name;

                // Show the bot entered the correct pattern (Visual cheat)
                revealBotPattern(winner);
            }

            // Next round delay
            setTimeout(nextRound, 3000);
        }

        function revealBotPattern(winnerId) {
            // Light up the bot's keys to match the letter
            const target = brailleMap[currentLetter]; // [1,0,1...]
            let keys;
            if(winnerId === 'cpu1') keys = document.querySelectorAll('.c1-key');
            if(winnerId === 'cpu2') keys = document.querySelectorAll('.c2-key');

            if(keys) {
                keys.forEach((k, i) => {
                    if(target[i]) k.classList.add('active');
                });
            }
        }

        function getAnimalName() {
            // Find current animal name based on emoji
            const txt = animalEmoji.innerText;
            const found = animals.find(a => a.emoji === txt);
            return found ? found.name : "Unknown";
        }

    </script>
</body>
</html>